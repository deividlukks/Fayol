# ‚úÖ Checklist Pr√©-Deploy - Fayol

> Checklist completo para garantir que tudo est√° pronto antes de colocar em produ√ß√£o

---

## üîê Seguran√ßa

### Credenciais e Secrets
- [ ] JWT_SECRET gerado com no m√≠nimo 64 caracteres aleat√≥rios
- [ ] JWT_REFRESH_SECRET diferente do JWT_SECRET
- [ ] Senhas de banco de dados fortes (16+ caracteres)
- [ ] REDIS_PASSWORD configurado
- [ ] SESSION_SECRET configurado
- [ ] Todas as senhas padr√£o alteradas
- [ ] Arquivo `.env` N√ÉO est√° no Git
- [ ] `.gitignore` inclui `.env*` e arquivos sens√≠veis

### Configura√ß√µes de Seguran√ßa
- [ ] CORS_ORIGIN configurado apenas com dom√≠nios permitidos
- [ ] Rate limiting ativado (RATE_LIMIT_MAX configurado)
- [ ] Helmet configurado no backend
- [ ] HTTPS for√ßado em todos os dom√≠nios
- [ ] SSL/TLS certificados instalados e v√°lidos
- [ ] HTTP Strict Transport Security (HSTS) ativado
- [ ] Content Security Policy (CSP) configurado

### Valida√ß√µes
- [ ] Valida√ß√£o de input em todos os endpoints
- [ ] Sanitiza√ß√£o de dados do usu√°rio
- [ ] SQL Injection: usando Prisma corretamente (sem raw queries n√£o sanitizadas)
- [ ] XSS Protection ativa
- [ ] CSRF tokens onde necess√°rio

---

## üóÑÔ∏è Banco de Dados

### Configura√ß√£o
- [ ] PostgreSQL instalado e rodando
- [ ] Banco de produ√ß√£o criado
- [ ] Usu√°rio do banco com privil√©gios corretos (n√£o root)
- [ ] DATABASE_URL configurada corretamente
- [ ] Connection pool configurado (max/min connections)
- [ ] Timezone do banco configurado (America/Sao_Paulo)

### Migrations e Schema
- [ ] Todas as migrations aplicadas (`prisma migrate deploy`)
- [ ] Seed executado com dados iniciais
- [ ] Verificado que o schema est√° atualizado
- [ ] Backup antes de qualquer migration em produ√ß√£o
- [ ] √çndices criados para queries frequentes

### Performance
- [ ] √çndices criados em colunas de busca frequente
- [ ] VACUUM e ANALYZE executados
- [ ] Query logging configurado (temporariamente para debug)
- [ ] Slow query log analisado

---

## üî¥ Backend (NestJS)

### Configura√ß√£o
- [ ] NODE_ENV=production
- [ ] PORT configurado (padr√£o: 3000)
- [ ] Log level apropriado (info ou warn, n√£o debug)
- [ ] ENABLE_SWAGGER=false em produ√ß√£o
- [ ] Vari√°veis de ambiente todas configuradas
- [ ] PM2 ou similar configurado para process management

### Build e Deploy
- [ ] Build de produ√ß√£o executado sem erros
- [ ] Depend√™ncias de produ√ß√£o instaladas (`pnpm install --prod`)
- [ ] node_modules de desenvolvimento removidos
- [ ] TypeScript compilado corretamente
- [ ] Source maps desabilitados (ou apenas para debug interno)

### Testes
- [ ] Testes unit√°rios passando
- [ ] Testes de integra√ß√£o passando
- [ ] Health check endpoint funcionando (`/api/v1/health`)
- [ ] Verificado que n√£o h√° console.log em produ√ß√£o

### Servi√ßos Externos
- [ ] Redis conectando corretamente
- [ ] Redis password configurado
- [ ] Conex√£o com servi√ßo de IA funcionando
- [ ] SMTP configurado para emails
- [ ] Telegram Bot token configurado (se aplic√°vel)
- [ ] WhatsApp Bot configurado (se aplic√°vel)

---

## üåê Frontend (Admin Panel)

### Build
- [ ] Build de produ√ß√£o executado
- [ ] Sem erros de TypeScript
- [ ] Sem warnings cr√≠ticos
- [ ] Bundle size otimizado (< 500KB gzipped)
- [ ] Images otimizadas

### Configura√ß√£o
- [ ] NEXT_PUBLIC_API_URL apontando para produ√ß√£o
- [ ] Vari√°veis de ambiente de produ√ß√£o configuradas
- [ ] Analytics configurado (Google Analytics, Mixpanel, etc.)
- [ ] Error tracking configurado (Sentry, etc.)

### Performance
- [ ] Lazy loading configurado
- [ ] Code splitting ativo
- [ ] Assets em CDN (se aplic√°vel)
- [ ] Service Worker configurado (PWA)
- [ ] Compression ativa (gzip/brotli)

### SEO & Meta
- [ ] Meta tags configuradas
- [ ] Open Graph tags
- [ ] Favicon configurado
- [ ] robots.txt configurado
- [ ] sitemap.xml gerado

---

## üöÄ Deploy & Infraestrutura

### Servidor
- [ ] Servidor com recursos suficientes (CPU, RAM, Disco)
- [ ] Node.js vers√£o correta instalada (v18+)
- [ ] Python instalado para servi√ßo de IA (v3.9+)
- [ ] PM2 instalado e configurado
- [ ] Auto-start configurado (pm2 startup)
- [ ] Firewall configurado (portas necess√°rias abertas)

### Dom√≠nios e DNS
- [ ] Dom√≠nio principal configurado
- [ ] Subdom√≠nios criados (api, admin, ai)
- [ ] DNS propagado (verificar com `nslookup`)
- [ ] SSL configurado para todos os dom√≠nios
- [ ] Redirecionamento HTTP ‚Üí HTTPS funcionando

### Proxy Reverso
- [ ] Nginx ou Apache configurado
- [ ] .htaccess com proxy para Node.js
- [ ] Headers de seguran√ßa configurados
- [ ] Compression ativa
- [ ] Rate limiting no proxy

### Backup
- [ ] Script de backup configurado
- [ ] Backup autom√°tico agendado (cron)
- [ ] Testado restore de backup
- [ ] Backup em local separado do servidor
- [ ] Reten√ß√£o de backups configurada (manter √∫ltimos 7 dias)

---

## üìä Monitoramento e Logs

### Logs
- [ ] Logs do backend sendo gravados
- [ ] Logs rotacionados (logrotate ou pm2-logrotate)
- [ ] Logs de erro separados
- [ ] Logs acess√≠veis via SSH
- [ ] Formato de log padronizado (JSON)

### Monitoramento
- [ ] PM2 monitoring ativo
- [ ] Health check configurado
- [ ] Uptime monitoring (UptimeRobot, Pingdom, etc.)
- [ ] Error tracking (Sentry, Bugsnag, etc.)
- [ ] Performance monitoring (New Relic, DataDog, etc.)
- [ ] Alertas configurados (email, Telegram, Slack)

### M√©tricas
- [ ] CPU usage monitorado
- [ ] RAM usage monitorado
- [ ] Disk space monitorado
- [ ] Network traffic monitorado
- [ ] Database connections monitoradas
- [ ] API response times monitoradas

---

## üß™ Testes de Produ√ß√£o

### Testes Funcionais
- [ ] Registro de usu√°rio funcionando
- [ ] Login funcionando
- [ ] Recupera√ß√£o de senha funcionando
- [ ] CRUD de contas funcionando
- [ ] CRUD de transa√ß√µes funcionando
- [ ] CRUD de categorias funcionando
- [ ] Dashboard carregando dados
- [ ] Relat√≥rios gerando corretamente
- [ ] Bot Telegram respondendo

### Testes de Performance
- [ ] Tempo de resposta da API < 500ms
- [ ] P√°gina inicial carrega < 3s
- [ ] Suporta 100 requisi√ß√µes simult√¢neas
- [ ] Sem memory leaks
- [ ] CPU usage normal (< 70%)
- [ ] Database queries otimizadas

### Testes de Seguran√ßa
- [ ] Tentativa de SQL Injection bloqueada
- [ ] XSS bloqueado
- [ ] CSRF tokens validando
- [ ] Rate limiting funcionando
- [ ] JWT inv√°lido rejeitado
- [ ] Permiss√µes de usu√°rio funcionando
- [ ] Upload de arquivos validado

---

## üì± Integra√ß√µes

### Telegram Bot
- [ ] Token configurado
- [ ] Webhook configurado
- [ ] Bot respondendo comandos
- [ ] Bot conectando com backend
- [ ] Mensagens sendo recebidas e enviadas

### WhatsApp Bot (se aplic√°vel)
- [ ] Provider configurado (Baileys ou Twilio)
- [ ] Sess√£o persistindo
- [ ] QR Code gerando (Baileys)
- [ ] Mensagens funcionando

### Email
- [ ] SMTP configurado
- [ ] Emails de boas-vindas enviando
- [ ] Emails de recupera√ß√£o de senha enviando
- [ ] Templates de email funcionando
- [ ] SPF/DKIM configurados (evitar spam)

### Servi√ßo de IA
- [ ] Servi√ßo rodando (porta 8000)
- [ ] Endpoint de sugest√£o de categoria funcionando
- [ ] An√°lise de gastos funcionando
- [ ] Detec√ß√£o de anomalias funcionando

---

## üìÑ Documenta√ß√£o

### Para Equipe
- [ ] README atualizado
- [ ] Documenta√ß√£o de API atualizada (Swagger)
- [ ] Guia de desenvolvimento atualizado
- [ ] Changelog atualizado
- [ ] Vari√°veis de ambiente documentadas

### Para Usu√°rios
- [ ] Documenta√ß√£o de usu√°rio criada
- [ ] FAQ criado
- [ ] Tutoriais em v√≠deo (opcional)
- [ ] Suporte configurado (email, chat, etc.)

---

## üîÑ Processo de Deploy

### Pre-Deploy
- [ ] Branch de produ√ß√£o criada
- [ ] Code review realizado
- [ ] Testes passando em staging
- [ ] Changelog atualizado com nova vers√£o
- [ ] Comunicado √† equipe sobre deploy

### Deploy
- [ ] Backup do banco antes do deploy
- [ ] Backup dos arquivos antes do deploy
- [ ] Deploy em janela de manuten√ß√£o (se poss√≠vel)
- [ ] Migrations aplicadas
- [ ] Aplica√ß√£o reiniciada

### Post-Deploy
- [ ] Health check passou
- [ ] Logs verificados (sem erros)
- [ ] Testes funcionais passando
- [ ] Monitoramento verificado
- [ ] Comunicado √† equipe sucesso do deploy
- [ ] Tag criada no Git (vX.X.X)

### Rollback (Plano B)
- [ ] Script de rollback preparado
- [ ] Backup facilmente restaur√°vel
- [ ] Processo de rollback documentado
- [ ] Equipe sabe como fazer rollback

---

## ‚úâÔ∏è Comunica√ß√£o

### Interna
- [ ] Equipe informada sobre deploy
- [ ] Janela de manuten√ß√£o comunicada
- [ ] Contatos de emerg√™ncia atualizados
- [ ] Runbook atualizado

### Externa (Usu√°rios)
- [ ] Status page configurado (opcional)
- [ ] Aviso de manuten√ß√£o (se necess√°rio)
- [ ] Email de novidades (changelog)
- [ ] Redes sociais atualizadas (opcional)

---

## üéØ Checklist Final

Antes de colocar em produ√ß√£o, responda SIM para todas:

- [ ] Testei todo o fluxo principal da aplica√ß√£o?
- [ ] Todos os endpoints cr√≠ticos est√£o funcionando?
- [ ] Todas as senhas padr√£o foram alteradas?
- [ ] O SSL est√° funcionando em todos os dom√≠nios?
- [ ] O backup autom√°tico est√° configurado?
- [ ] O monitoramento est√° ativo?
- [ ] Tenho um plano de rollback?
- [ ] A equipe est√° ciente do deploy?
- [ ] Documenta√ß√£o est√° atualizada?
- [ ] Sei quem contatar em caso de problemas?

---

## üö® Checklist de Emerg√™ncia

Se algo der errado, siga esta ordem:

1. [ ] Verificar logs imediatamente
2. [ ] Executar health check
3. [ ] Verificar status PM2
4. [ ] Verificar conex√£o com banco
5. [ ] Verificar espa√ßo em disco
6. [ ] Se necess√°rio, fazer rollback
7. [ ] Comunicar equipe sobre o problema
8. [ ] Documentar o incidente
9. [ ] Criar post-mortem ap√≥s resolu√ß√£o

---

## üìû Contatos de Emerg√™ncia

```
Suporte Hospedagem: __________________
DBA: __________________
DevOps: __________________
Tech Lead: __________________
```

---

**Este checklist deve ser seguido TODA vez antes de um deploy em produ√ß√£o!**

**√öltima atualiza√ß√£o**: 2025-10-12
**Vers√£o**: 1.0.0
